<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="stylesheet" href="codemirror/codemirror.css">
      <link rel="stylesheet" href="codemirror/theme/ayu-dark.css">
      <link rel="stylesheet" href="codemirror/addon/hint/show-hint.css">
      <link rel="stylesheet" href="codemirror/addon/fold/foldgutter.css">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500;600&display=swap">
      <link rel="stylesheet" href="styles/editor.css">
      <link rel="stylesheet" href="codemirror/theme/default.css">
      <link rel="stylesheet" href="codemirror/addon/scroll/simplescrollbars.css">
      <link rel="stylesheet" href="codemirror/addon/lint/lint.css">
   </head>
   <body>
      <div class="app-container">
         <!-- Header -->
         <header class="header">
            <div class="header-left">
               <button type="button" id="sidebarToggle" class="sidebar-toggle" aria-label="Toggle sidebar">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                     <line x1="3" y1="12" x2="21" y2="12"></line>
                     <line x1="3" y1="6" x2="21" y2="6"></line>
                     <line x1="3" y1="18" x2="21" y2="18"></line>
                  </svg>
               </button>
               <div class="logo">
                  <div class="logo-icon">
                     <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="3" width="18" height="18" rx="2" fill="url(#gradient)"/>
                        <path d="M8 12l2 2 4-4" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <defs>
                           <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                              <stop offset="0%" style="stop-color:#6366f1"/>
                              <stop offset="100%" style="stop-color:#8b5cf6"/>
                           </linearGradient>
                        </defs>
                     </svg>
                  </div>
                  <a href="/dashboard.html" style="text-decoration: none; color: inherit;">
                     <div class="logo-text">
                        <span class="logo-title">CodeTweak</span>
                        <span class="logo-subtitle">Editor</span>
                     </div>
                  </a>
               </div>
            </div>
            <div class="header-center">
            </div>
            <div class="header-right">
               <div class="header-controls">
                  <button type="button" class="control-btn" id="lintBtn" title="Toggle linting">
                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                     </svg>
                     <span id="lintBtnText">Lint: Off</span>
                  </button>
                  <button type="button" class="control-btn" id="autosaveBtn" title="Toggle autosave">
                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                        <polyline points="7 3 7 8 15 8"></polyline>
                     </svg>
                     <span id="autosaveBtnText">Autosave: Off</span>
                  </button>
               </div>
               <div class="header-actions">
                  <div class="status-info">
                     <div class="status-badge" id="scriptStatusBadge">
                        <div class="status-dot"></div>
                        <span>Unsaved Changes</span>
                     </div>
                  </div>
                  <button type="button" id="saveBtn" class="save-btn">
                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                        <polyline points="7 3 7 8 15 8"></polyline>
                     </svg>
                     Save Script
                  </button>
               </div>
            </div>
         </header>
         <!-- Main -->
         <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
               <div class="sidebar-content">
                  <!-- Info-->
                  <div class="settings-section collapsible" data-section="info">
                     <button class="section-header" type="button">
                        <div class="section-icon">
                           <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                              <circle cx="12" cy="12" r="3"></circle>
                              <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1"></path>
                           </svg>
                        </div>
                        <span class="section-title">Script Information</span>
                        <svg class="section-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                           <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                     </button>
                     <div class="section-content">
                        <div class="form-group">
                           <label for="scriptName" class="form-label">
                           <span>Script Name</span>
                           <span class="label-required">*</span>
                           </label>
                           <input type="text" id="scriptName" class="form-input" placeholder="My Awesome Script" required>
                        </div>
                        <div class="form-group">
                           <label for="scriptAuthor" class="form-label">Author</label>
                           <input type="text" id="scriptAuthor" class="form-input" placeholder="Your Name">
                        </div>
                        <div class="form-group">
                           <label for="scriptVersion" class="form-label">Version</label>
                           <input type="text" id="scriptVersion" class="form-input" placeholder="1.0.0" pattern="[0-9]+\.[0-9]+\.[0-9]+">
                        </div>
                        <div class="form-group">
                           <label for="scriptDescription" class="form-label">Description</label>
                           <textarea id="scriptDescription" class="form-textarea" placeholder="Describe what your script does..." rows="3"></textarea>
                        </div>
                     </div>
                  </div>
                  <!-- GM API Access -->
                  <div class="settings-section collapsible" data-section="api">
                     <button class="section-header" type="button">
                        <div class="section-icon">
                           <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                              <path d="M12 2 L12 22 M2 12 L22 12"></path> 
                           </svg>
                        </div>
                        <span class="section-title">GM API Access</span>
                        <svg class="section-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                           <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                     </button>
                     <div class="section-content">
                        <div class="form-group-checkbox">
                           <input type="checkbox" id="gmSetValue" class="form-checkbox">
                           <label for="gmSetValue">GM_setValue</label>
                        </div>
                        <div class="form-group-checkbox">
                           <input type="checkbox" id="gmGetValue" class="form-checkbox">
                           <label for="gmGetValue">GM_getValue</label>
                        </div>
                        <div class="form-group-checkbox">
                           <input type="checkbox" id="gmDeleteValue" class="form-checkbox">
                           <label for="gmDeleteValue">GM_deleteValue</label>
                        </div>
                        <div class="form-group-checkbox">
                           <input type="checkbox" id="gmListValues" class="form-checkbox">
                           <label for="gmListValues">GM_listValues</label>
                        </div>
                        <div class="form-group-checkbox">
                           <input type="checkbox" id="gmOpenInTab" class="form-checkbox">
                           <label for="gmOpenInTab">GM_openInTab</label>
                        </div>
                        <div class="form-group-checkbox">
                           <input type="checkbox" id="gmNotification" class="form-checkbox">
                           <label for="gmNotification">GM_notification</label>
                        </div>
                        <div class="form-group-checkbox">
                           <input type="checkbox" id="gmGetResourceText" class="form-checkbox">
                           <label for="gmGetResourceText">GM_getResourceText</label>
                        </div>
                        <div class="form-group-checkbox">
                           <input type="checkbox" id="gmGetResourceURL" class="form-checkbox">
                           <label for="gmGetResourceURL">GM_getResourceURL</label>
                        </div>
                        <div class="form-group-checkbox">
                           <input type="checkbox" id="gmSetClipboard" class="form-checkbox">
                           <label for="gmSetClipboard">GM_setClipboard</label>
                        </div>
                     </div>
                  </div>
                  <!-- Script Resources -->
                  <div class="settings-section collapsible" data-section="resources">
                     <button class="section-header" type="button">
                        <div class="section-icon">
                           <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                              <polyline points="7 10 12 15 17 10"></polyline>
                              <line x1="12" y1="15" x2="12" y2="3"></line>
                           </svg>
                        </div>
                        <span class="section-title">Script Resources</span>
                        <svg class="section-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                           <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                     </button>
                     <div class="section-content">
                        <div class="form-group">
                           <label for="scriptResources" class="form-label">Resource Declarations</label>
                           <textarea id="scriptResources" class="form-textarea" placeholder="@resource resourceName resourceURL\n@resource anotherName anotherURL" rows="4"></textarea>
                           <p class="form-hint">Declare resources one per line, e.g., @resource customCSS https://example.com/styles.css</p>
                        </div>
                     </div>
                  </div>
                  <!-- Exec -->
                  <div class="settings-section collapsible" data-section="execution">
                     <button class="section-header" type="button">
                        <div class="section-icon">
                           <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                              <polygon points="5 3 19 12 5 21 5 3"></polygon>
                           </svg>
                        </div>
                        <span class="section-title">Execution Settings</span>
                        <svg class="section-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                           <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                     </button>
                     <div class="section-content">
                        <div class="form-group">
                           <label for="targetUrl" class="form-label">
                           <span>Target URLs</span>
                           <span class="label-required">*</span>
                           </label>
                           <div class="url-input-group">
                              <input type="url" id="targetUrl" class="form-input" placeholder="https://example.com/*" required>
                              <button type="button" id="addUrlBtn" class="add-btn">
                                 <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                 </svg>
                                 Add
                              </button>
                           </div>
                           <div id="urlList" class="url-list"></div>
                        </div>
                        <div class="form-group">
                           <label for="runAt" class="form-label">Run Timing</label>
                           <select id="runAt" class="form-select">
                              <option value="document_start">ASAP</option>
                              <option value="document_end">Dom loaded</option>
                              <option value="document_idle" selected>Page loaded</option>
                           </select>
                        </div>
                     </div>
                  </div>
               </div>
            </aside>
            <!-- Editor-->
            <main class="editor-area">
               <div id="statusMessage" class="status-message"></div>
               <div class="editor-container">
                  <textarea id="codeEditor" class="code-editor"></textarea>
               </div>
               <div class="editor-toolbar">
                  <div class="toolbar-group">
                     <button type="button" class="toolbar-btn" id="formatBtn" title="Format code (Alt+Shift+F)">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                           <path d="M4 7V4h16v3M9 20h6M12 4v16"></path>
                        </svg>
                        Format
                     </button>
                  </div>
                  <div class="toolbar-info">
                     <span id="cursorInfo" class="cursor-info">Line 1, Column 1</span>
                  </div>
               </div>
            </main>
         </div>
      </div>
      <!-- Scripts -->
      <script src="codemirror/codemirror.js"></script>
      <script src="codemirror/javascript.js"></script>
      <script src="codemirror/addon/edit/matchbrackets.js"></script>
      <script src="codemirror/addon/edit/closebrackets.js"></script>
      <script src="codemirror/addon/fold/foldcode.js"></script>
      <script src="codemirror/addon/fold/foldgutter.js"></script>
      <script src="codemirror/addon/fold/brace-fold.js"></script>
      <script src="codemirror/addon/hint/show-hint.js"></script>
      <script src="codemirror/addon/hint/javascript-hint.js"></script>
      <script src="codemirror/addon/lint/lint.js"></script>
      <script src="codemirror/addon/lint/javascript-lint.js"></script>
      <script src="codemirror/addon/comment/comment.js"></script>
      <script src="codemirror/addon/scroll/simplescrollbars.js"></script>
      <script src="codemirror/addon/edit/trailingspace.js"></script>
      <script src="codemirror/addon/edit/continuelist.js"></script>
      <script defer src="codemirror/lib/jshint.js"></script>
      <script defer src="codemirror/lib/beautify.min.js"></script>
      <script src="./utils/editor-managers.js"></script>
      <script src="editor.js"></script>
   </body>
</html>