<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-i18n="aiSettingsTitle">AI DOM Editor Settings</title>
  <link rel="stylesheet" href="../../assets/styles/ai/ai_settings.css">
  <script src="../../utils/theme_manager.js"></script>
</head>
<body>
  <div class="settings-page">
    <header class="settings-header">
      <div>
        <h1 data-i18n="aiSettingsTitle">AI DOM Editor Settings</h1>
        <p data-i18n="aiSettingsSubtitle">Simple profile-based setup for providers, keys, and models.</p>
      </div>
      <button type="button" class="btn-primary" id="addKeyBtn" data-i18n-title="aiSettingsNewProfile">
        <i data-feather="plus" width="16" height="16"></i>
        <span data-i18n="aiSettingsNewProfile">New Profile</span>
      </button>
    </header>

    <main class="settings-layout">
      <aside class="profiles-panel">
        <div class="panel-head">
          <h2 data-i18n="aiSettingsProfiles">Profiles</h2>
          <span class="count-badge" id="profileCount">0</span>
        </div>
        <div id="apiKeysList" class="profiles-list"></div>
      </aside>

      <section class="editor-panel">
        <form id="settingsForm" class="form-shell">
          <div class="section-head">
            <h2 data-i18n="aiSettingsProfileConfig">Profile Configuration</h2>
            <p id="activeProfileText" data-i18n="aiSettingsProfileHintNew">New unsaved profile</p>
          </div>

          <div class="form-grid">
            <div class="field full">
              <label for="provider" data-i18n="aiSettingsProvider">Provider</label>
              <select id="provider" required>
                <option value="" data-i18n="aiSettingsSelectProvider">Select provider...</option>
                <option value="openai" data-i18n="aiSettingsProviderOpenAI">OpenAI</option>
                <option value="anthropic" data-i18n="aiSettingsProviderAnthropic">Anthropic</option>
                <option value="google" data-i18n="aiSettingsProviderGoogleGemini">Google Gemini</option>
                <option value="mistral" data-i18n="aiSettingsProviderMistral">Mistral</option>
                <option value="aimlapi" data-i18n="aiSettingsProviderAimlapi">AIML API</option>
                <option value="custom" data-i18n="aiSettingsProviderCustom">Custom Endpoint</option>
              </select>
            </div>

            <div class="field full">
              <label for="apiKey" data-i18n="aiSettingsApiKey">API Key</label>
              <div class="inline-input">
                <input type="password" id="apiKey" placeholder="Paste API key" data-i18n-placeholder="aiSettingsApiKeyPlaceholder" required />
                <button type="button" class="btn-icon" id="toggleApiKey" title="Show or hide key" data-i18n-title="aiSettingsToggleKey">
                  <i data-feather="eye" width="16" height="16"></i>
                </button>
              </div>
            </div>

            <div class="field full" id="endpointGroup" style="display: none;">
              <label for="endpoint" data-i18n="aiSettingsApiEndpoint">Endpoint</label>
              <input type="url" id="endpoint" placeholder="https://api.example.com/v1/chat/completions" data-i18n-placeholder="aiSettingsEndpointPlaceholder" />
              <small data-i18n="aiSettingsEndpointRequiredHint">Only required for custom providers.</small>
            </div>

            <div class="field full" id="modelGroup">
              <label for="model" data-i18n="aiSettingsModel">Model</label>
              <div class="inline-input model-row">
                <select id="model" required>
                  <option value="" data-i18n="aiSettingsSelectModel">Select model...</option>
                </select>
                <button type="button" class="btn-secondary" id="fetchModelsBtn" data-i18n-title="aiSettingsFetchModels">
                  <i data-feather="refresh-cw" width="14" height="14"></i>
                  <span data-i18n="aiSettingsSyncModels">Sync Models</span>
                </button>
              </div>
            </div>

            <div class="field">
              <label for="temperature" data-i18n="aiSettingsTemperature">Temperature</label>
              <div class="range-wrap">
                <input type="range" id="temperature" min="0" max="1" step="0.1" value="0.4" />
                <span id="temperatureValue">0.4</span>
              </div>
            </div>

            <div class="field">
              <label for="maxTokens" data-i18n="aiSettingsMaxTokens">Max Tokens</label>
              <input type="number" id="maxTokens" min="100" max="8000" value="1800" />
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn-secondary" id="testConnection" data-i18n-title="aiSettingsTestConnection">
              <i data-feather="activity" width="16" height="16"></i>
              <span data-i18n="aiSettingsTest">Test</span>
            </button>
            <div class="action-group">
              <button type="button" class="btn-text" id="resetBtn" data-i18n="aiSettingsResetAll">Reset All</button>
              <button type="submit" class="btn-primary" id="saveBtn" data-i18n-title="aiSettingsSaveProfile">
                <i data-feather="save" width="16" height="16"></i>
                <span data-i18n="aiSettingsSaveProfile">Save Profile</span>
              </button>
            </div>
          </div>
        </form>

        <div class="help-card">
          <h3 data-i18n="aiSettingsQuickStart">Quick Start</h3>
          <p data-i18n="aiSettingsQuickStartSteps">1. Create a profile 2. Paste key 3. Choose model 4. Save.</p>
          <p>
            <span data-i18n="aiSettingsLinksLabel">Links:</span>
            <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI</a>
            · <a href="https://console.anthropic.com/" target="_blank">Anthropic</a>
            · <a href="https://aistudio.google.com/app/apikey" target="_blank">Google</a>
            · <a href="https://console.mistral.ai/" target="_blank">Mistral</a>
          </p>
        </div>
      </section>
    </main>

    <div class="toast" id="toast">
      <i class="toast-icon" data-feather="check" width="18" height="18"></i>
      <span class="toast-message" id="toastMessage"></span>
    </div>
  </div>

  <script type="module" src="ai_settings.js"></script>
</body>
</html>
